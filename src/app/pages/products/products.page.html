<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Winys Store</ion-title>
    <ion-buttons slot="end">
      @if (!isLoggedIn()) {
        <ion-button (click)="navigateToLogin()">
          <ion-icon name="log-in-outline" slot="start"></ion-icon>
          Login
        </ion-button>
      }
      @if (isLoggedIn()) {
        <ion-button (click)="goToCart()">
          <ion-icon name="cart-outline" slot="start"></ion-icon>
          Cart ({{ getCartItemCount() }})
        </ion-button>
        <ion-button (click)="goToProfile()">
          Welcome, {{ getCurrentUser()?.firstName }}
        </ion-button>
        <ion-button (click)="logout()" color="danger">
          <ion-icon name="log-out-outline" slot="icon-only"></ion-icon>
        </ion-button>
      }
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="products-container">
    <section class="hero-section">
      <div class="hero-copy">
        <h1 class="page-title">Our Premium Wine Collection</h1>
        <p class="page-subtitle">30 exquisite wines from around the world</p>
      </div>
    </section>
    
    <ion-grid>
      <ion-row>
        @for (product of products; track product.id) {
          <ion-col size="12" size-md="6" size-lg="4">
            <ion-card class="product-card premium-card">
              <ion-card-header class="card-header">
                <ion-card-title class="product-name">{{ product.name }}</ion-card-title>
                <div class="product-details">
                  <span class="wine-type {{ product.type.toLowerCase() }}">{{ product.type }}</span>
                  <span class="wine-region">{{ product.region }}</span>
                </div>
              </ion-card-header>

              <ion-card-content class="card-content">
                <div class="product-image">
                  <div class="image-frame">
                    @if (product.name === 'Cabernet Sauvignon') {
                      <img src="assets/images/yellow_tail.png" [alt]="product.name" loading="lazy" />
                    } @else {
                      <ion-icon class="image-placeholder-icon" name="wine-outline"></ion-icon>
                    }
                  </div>
                </div>

                <div class="pricing">
                  <div class="right">
                    <p class="price">${{ product.price }}</p>
                    <ion-button fill="solid" (click)="addToCart(product)" color="primary">
                      <ion-icon name="cart-outline" slot="start"></ion-icon>
                      Add
                    </ion-button>
                  </div>
                </div>

                <div class="card-footer">
                  <div class="rating" aria-label="Rated 4 out of 5">
                    <ion-icon name="star" class="star filled"></ion-icon>
                    <ion-icon name="star" class="star filled"></ion-icon>
                    <ion-icon name="star" class="star filled"></ion-icon>
                    <ion-icon name="star" class="star filled"></ion-icon>
                    <ion-icon name="star-outline" class="star"></ion-icon>
                  </div>
                </div>
              </ion-card-content>
            </ion-card>
          </ion-col>
        }
      </ion-row>
    </ion-grid>
  </div>
</ion-content>